<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Q-Tee</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg bg-white shadow-sm mb-3">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">Q-Tee</a>
    <div class="d-flex gap-2">
      <button id="openSettings" class="btn btn-outline-secondary btn-sm">Settings</button>
      <button id="importBtn" class="btn btn-outline-success btn-sm">Import</button>
      <button id="exportBtn" class="btn btn-outline-primary btn-sm">Export</button>
      <button id="syncBtn" class="btn btn-primary btn-sm">Sync ↻</button>
    </div>
  </div>
</nav>

<div class="container-fluid">
  <div class="row g-3">
    <div class="col-lg-8">
      <div class="card shadow-sm">
        <div class="card-body">
          <!-- Top selectors -->
          <div class="row g-2 align-items-end mb-2">
            <div class="col-md-3">
              <label class="form-label">Exam</label>
              <div class="input-group">
                <select id="examSelect" class="form-select"></select>
                <button id="btnAddExam" class="btn btn-outline-secondary">Add</button>
              </div>
            </div>
            <div class="col-md-3">
              <label class="form-label">Subject</label>
              <div class="input-group">
                <select id="subjectSelect" class="form-select"></select>
                <button id="btnAddSubject" class="btn btn-outline-secondary">Add</button>
              </div>
            </div>
            <div class="col-md-3">
              <label class="form-label">Book</label>
              <div class="input-group">
                <select id="bookSelect" class="form-select"></select>
                <button id="btnAddBook" class="btn btn-outline-secondary">Add</button>
              </div>
            </div>
            <div class="col-md-3">
              <label class="form-label">Chapter</label>
              <div class="input-group">
                <select id="chapterSelect" class="form-select"></select>
                <button id="btnAddChapter" class="btn btn-outline-secondary">Add</button>
              </div>
            </div>

            <div class="col-12 mt-2 d-grid">
              <div class="d-flex gap-2">
                <button id="loadChapter" class="btn btn-primary">Load Chapter</button>
                <button id="markAllCorrect" class="btn btn-success">Mark All Correct</button>
                <button id="markAllWrong" class="btn btn-danger">Mark All Wrong</button>
                <button id="markAllNA" class="btn btn-warning">Mark All Not Attempted</button>
                <button id="newAttempt" class="btn btn-secondary">➕ New Attempt</button>
                <button id="showStatsBtn" class="btn btn-info ms-auto">Show Stats</button>
              </div>
            </div>
          </div>

          <div id="controls" class="mb-2 d-none">
            <div class="d-flex gap-2 mb-2 flex-wrap">
              <span id="chapterInfo" class="ms-auto muted-small"></span>
            </div>
          </div>

          <div class="table-wrap">
            <table class="table table-sm table-bordered align-middle" id="questionsTable">
              <thead class="table-light">
                <tr>
                  <th style="width:64px">Q#</th>
                  <th>Notes</th>
                  <th colspan="3" class="text-center">Last 3 Attempts (old → recent)</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div id="saveHint" class="mt-2 muted-small"></div>
        </div>
      </div>
    </div>

    <div class="col-lg-4">
      <div class="card shadow-sm">
        <div class="card-body sidebar">
          <h6>Stats (click "Show Stats")</h6>
          <div id="statsArea" class="mb-3 muted-small"></div>
          <hr>
          <div id="statsDetails"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Settings Modal -->
<div class="modal" id="settingsModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Settings & GitHub</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body">
        <div class="row g-2">
          <div class="col-md-6">
            <label class="form-label">GitHub Owner</label>
            <input id="cfgOwner" class="form-control" placeholder="username or org">
          </div>
          <div class="col-md-6">
            <label class="form-label">Repository</label>
            <input id="cfgRepo" class="form-control" placeholder="repo-name">
          </div>
          <div class="col-md-6">
            <label class="form-label">Data folder path</label>
            <input id="cfgPath" class="form-control" placeholder="data">
          </div>
          <div class="col-md-6">
            <label class="form-label">Branch</label>
            <input id="cfgBranch" class="form-control" placeholder="main">
          </div>
          <div class="col-12">
            <label class="form-label">GitHub Personal Access Token (PAT)</label>
            <input id="cfgToken" class="form-control" placeholder="Paste PAT; stored in localStorage">
            <div class="form-text">Token needs repo contents permission. Revoke if compromised.</div>
          </div>
          <div class="col-12 mt-2">
            <hr>
            <button id="btnLoadExams" class="btn btn-outline-primary btn-sm">Load exams.json from repo</button>
            <button id="btnInitExams" class="btn btn-outline-success btn-sm">Init exams.json (create)</button>
            <button id="btnSaveSettings" class="btn btn-primary btn-sm">Save</button>
          </div>
        </div>

        <hr>
        <div><strong>Note</strong>
          <pre class="small">Files used:
data/exams.json  -> list of exam names
data/{exam}.json -> per-exam storage (subjects -> books -> chapters -> questions)
When saving, folder path is constructed as: {cfgPath}/{filename}.json (no nested .json mistakes).</pre>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Stats Modal -->
<div class="modal" id="statsModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Stats</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body">
        <div id="statsModalContent"></div>
        <div class="mt-3"><button id="closeStats" class="btn btn-secondary" data-bs-dismiss="modal">Close</button></div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="/assets/js/main.js"></script>
</body>
</html>
